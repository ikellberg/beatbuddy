---
name: update-documentation
description: Проверяет и обновляет документацию проекта, особенно project_state.md. Анализирует изменения в коде, сравнивает с текущей документацией и обновляет Project State и архитектурную документацию. Используй когда пользователь просит обновить документацию, проверить Project State или после изменений кода от Opus или других разработчиков.
---

# Обновление документации

Обновляет документацию проекта, в первую очередь `project_state.md`, на основе изменений в коде.

## Когда использовать

- Пользователь говорит "обнови документацию" или "update documentation"
- Пользователь говорит "проверь Project State" или "check Project State"
- После изменений кода: "Opus добавил [фичу]. Обнови Project State"
- Периодические проверки: "Проверь актуальность Project State после последних изменений"

## Что делает этот skill

1. **Анализирует изменения в коде**
   - Проверяет git diff и изменённые файлы
   - Определяет новые фичи, рефакторинг, исправления багов

2. **Сравнивает с документацией**
   - Читает `project_state.md`
   - Сравнивает текущую структуру кода с задокументированной архитектурой
   - Выявляет несоответствия

3. **Обновляет документацию**
   - Обновляет раздел "Текущий статус" (всегда должен быть актуальным)
   - Обновляет раздел "Что сделано" (отражает реализованные фичи)
   - Обновляет архитектурные схемы (соответствуют реальной структуре кода)
   - Обновляет таблицу типов документов (актуальные типы)
   - Отмечает выполненные этапы реализации

4. **Отчитывается об изменениях**
   - Перечисляет что было обновлено
   - Выделяет найденные проблемы

## Приоритеты при обновлении

При обновлении `project_state.md` приоритизируй:

1. **Раздел "Текущий статус"** — должен всегда быть актуальным
2. **Раздел "Что сделано"** — отражает реализованные фичи
3. **Архитектурные схемы** — соответствуют реальной структуре кода
4. **Таблица типов документов** — актуальные типы и их статус
5. **Этапы реализации** — отмечай выполненные задачи

## Процесс обновления

### Шаг 1: Анализ изменений

- Проверь git status и diff
- Прочитай изменённые файлы
- Определи:
  - Какие новые фичи добавлены
  - Какие новые типы документов поддерживаются
  - Какой рефакторинг выполнен
  - Какие изменения в архитектуре

### Шаг 2: Сравнение с документацией

- Прочитай `project_state.md`
- Сравни структуру кода с задокументированной архитектурой
- Проверь актуальность таблицы типов документов
- Убедись, что этапы реализации соответствуют реальности

### Шаг 3: Обновление документации

Обнови `project_state.md`:
- Раздел 2 "Текущий статус" — обнови дату и что нового
- Раздел 14 "Что сделано" — добавь новые фичи
- Раздел 137 "Типы документов" — обнови таблицу если добавлены новые типы
- Раздел 322 "Этапы реализации" — отметь выполненные задачи
- Архитектурные схемы — обнови если структура изменилась

Обнови `docs/architecture_analysis.md` если архитектура изменилась:
- Отрази новую структуру
- Обнови рекомендации при необходимости

### Шаг 4: Отчёт

Перечисли что было обновлено:
- Какие разделы изменены
- Какая новая информация добавлена
- Какие проблемы или несоответствия найдены

## Примеры

**Пример 1: После добавления нового типа документа**
```
Пользователь: "Opus добавил обработку счетов-фактур. Обнови Project State."

Действия:
1. Анализирую изменения в коде (новый обработчик, обновление классификатора)
2. Обновляю раздел "Что сделано"
3. Обновляю таблицу типов документов
4. Обновляю архитектурную схему если нужно
5. Отчёт: "Обновлён Project State: добавлен invoice_ru в таблицу типов документов"
```

**Пример 2: Периодическая проверка**
```
Пользователь: "Проверь актуальность Project State."

Действия:
1. Анализирую все последние изменения в коде
2. Сравниваю с Project State
3. Выявляю несоответствия
4. Обновляю документацию
5. Отчёт: "Найдено 3 несоответствия, обновлён Project State"
```

## Что НЕ делать

- Не изменять код (код пишет Opus)
- Не рефакторить без явного запроса
- Не оптимизировать производительность
- Не исправлять баги в коде

## Связанные файлы

- `project_state.md` — главный документ состояния проекта

